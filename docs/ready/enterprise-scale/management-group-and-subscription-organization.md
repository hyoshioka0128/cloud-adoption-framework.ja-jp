---
title: 管理グループとサブスクリプションの組織
description: 管理グループとサブスクリプションの編成。
author: BrianBlanchard
ms.author: brblanch
ms.date: 06/15/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.custom: think-tank
ms.openlocfilehash: a7f668ad5fda17e16945dd9032e7cca114b135f3
ms.sourcegitcommit: 2aeb418ad97f3bdb7ce1e5ef76c0f3cbea9a57e7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2021
ms.locfileid: "106503456"
---
# <a name="management-group-and-subscription-organization"></a>管理グループとサブスクリプションの組織

![管理グループの階層を示す図。](./media/sub-org.png)

"_図 1:管理グループの階層。_

## <a name="define-a-management-group-hierarchy"></a>管理グループの階層を定義する

Azure Active Directory (Azure AD) テナント内の管理グループの構造では組織のマッピングがサポートされてており、組織で大規模な Azure の導入を計画するときは十分に検討する必要があります。

**設計上の考慮事項:**

- 管理グループを使用すると、Azure Policy を介してポリシーとイニシアティブの割り当てを集約できます。
- 管理グループのツリーでは、[最大 6 レベルの深さ](/azure/governance/management-groups/overview#hierarchy-of-management-groups-and-subscriptions)までサポートできます。 この制限には、テナント ルート レベルまたはサブスクリプション レベルは含まれません。
- 管理グループの操作に対して Azure ロールベースのアクセス制御 (Azure RBAC) 認可は既定で有効になっていないため、Azure AD テナント内のどのプリンシパル (ユーザー、サービス プリンシパル) も新しい管理グループを作成できます。
- 既定では、新しいサブスクリプションはすべてルート管理グループに配置されます。

**設計上の推奨事項:**

- できる限り、管理グループの階層は、3 ないし 4 レベル以下のある程度フラットなものにします。 この制限により、管理のオーバーヘッドと複雑さが軽減されます。
- 組織の構造を深い入れ子になった管理グループ階層に複製しないようにします。 管理グループは、ポリシーの割り当てと課金のために使用する必要があります。 このアプローチには、エンタープライズ規模のアーキテクチャで意図する目的のために管理グループを使用する必要があります。これにより、同じ管理グループ レベルで同じ種類のセキュリティとコンプライアンスを必要とするワークロードに対して Azure ポリシーが提供されます。
- ルート レベルの管理グループの下に管理グループを作成して、ホストするワークロード (アーキタイプ) の種類と、セキュリティ、コンプライアンス、接続性、機能のニーズに基づくワークロードの種類を表します。 このグループ化構造により、セキュリティ、コンプライアンス、接続、機能について同じ設定を必要とするすべてのワークロードに対し、管理グループ レベルで適用される一連の Azure ポリシーを使用できます。
- Azure Policy で適用または追加できるリソース タグを使用して、管理グループ階層全体のクエリと階層間の水平移動を行うことができます。 これにより、複雑な管理グループ階層を使用しなくても、検索のニーズに合わせてリソースをグループ化できます。
- ユーザーが Azure をすぐに試すことができるように、最上位レベルのサンドボックス管理グループを作成します。 次にユーザーは、運用環境でまだ許可されていない可能性があるリソースを試すことができます。 サンドボックスは、開発、テスト、運用の各環境から分離されています。
  - 最上位レベルのサンドボックス管理グループの詳細なガイダンスについては、[実装ガイドライン](./implementation-guidelines.md#sandbox-governance-guidance)をご覧ください。
- 管理グループ管理操作、サブスクリプション管理操作、ロールの割り当てを実行するには、専用のサービス プリンシパル名 (SPN) を使用します。 SPN を使用することは、昇格された権利を持つユーザーの数が減り、最小特権ガイドラインに従うということになります。
- ここで説明した SPN にルート レベルでのアクセス権を付与するには、ルート管理グループのスコープ (`/`) で `User Access Administrator` Azure ロールを割り当てます。 SPN にアクセス許可を付与した後は、`User Access Administrator` ロールを安全に削除できます。 これにより、SPN のみが `User Access Administrator` ロールの一部となります。
- ルート管理グループのスコープ (`/`) で、前述の SPN に `Contributor` アクセス許可を割り当てると、テナント レベルの操作が可能になります。 このアクセス許可レベルでは、その SPN を使用して、組織内の任意のサブスクリプションに対するリソースのデプロイと管理を確実に行うことができます。
- 共通プラットフォーム ポリシーと Azure ロールの割り当てをサポートするには、ルート管理グループの下に `Platform` 管理グループを作成します。 このグループ化構造では、Azure 基盤に使用されるサブスクリプションにさまざまなポリシーを確実に適用できます。 また、共通リソースの課金が、1 つの基盤サブスクリプション セットで確実に集中管理されます。
- ルート管理グループのスコープ (`/`) で行われる Azure Policy の割り当ての数を制限します。 この制限により、下位レベルの管理グループで継承されるポリシーのデバッグが最小限に抑えられます。
- エンタープライズ規模のランディング ゾーンで使用可能なポリシーを使用して、管理グループまたはサブスクリプションのスコープでコンプライアンス要件を適用します。 対処できるガバナンス要件の詳細については、「[ポリシー主導のガバナンス](#policy-driven-governance)」セクションのガイダンスを参照してください。
- 管理グループの[階層設定](/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization)で Azure RBAC 承認を有効にすることにより、特権のあるユーザーのみがテナントの管理グループを操作できるようにします (既定では、すべてのユーザーがルート管理グループの下に独自の管理グループを作成することが承認されています)。
- 新しいサブスクリプションに対して既定の専用管理グループを[構成](/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group)して、ルート管理グループの下にサブスクリプションが配置されないようにします。 これは、MSDN または Visual Studio の特典とサブスクリプションの対象ユーザーがいる場合に特に重要です。 このような管理グループの候補としては、`Sandbox` 管理グループがあります。

## <a name="subscription-organization-and-governance"></a>サブスクリプションの編成とガバナンス

サブスクリプションは、Azure 内での管理、課金、スケールの単位です。 大規模な Azure 導入を計画するときに、重要な役割を果たします。 このセクションは、重要な要素に基づいて、サブスクリプション要件を把握し、ターゲット サブスクリプションを設計する場合に役立ちます。 それらの要素とは、環境の種類、所有権とガバナンス モデル、組織構造、アプリケーション ポートフォリオです。

**設計上の考慮事項:**

- サブスクリプションは、Azure ポリシーを割り当てるための境界として機能します。 たとえば、支払いカード業界 (PCI) のワークロードなど、セキュリティで保護されたワークロードには、通常、コンプライアンスを実現するために追加のポリシーが必要です。 管理グループを使用して PCI コンプライアンスを必要とするワークロードをグループ化する代わりに、サブスクリプションで同じ分離を実現できます。 これにより、少数のサブスクリプションが含まれる管理グループが多数作成されるのを防ぐことができます。
- サブスクリプションはスケール ユニットとして機能します。これにより、コンポーネントのワークロードをプラットフォームの[サブスクリプション制限](/azure/azure-subscription-service-limits)内でスケーリングできます。 ワークロードの設計セッションの間に、サブスクリプションのリソース制限を考慮してください。
- サブスクリプションによって、ガバナンスと分離のための管理境界が提供され、問題が明確に分離されます。
- Azure AD テナントで Enterprise Agreement 加入契約サブスクリプションだけを使用するよう制限するために実行できる (将来的に自動化が予定されている) 手動プロセスがあります。 このプロセスにより、ルート管理グループのスコープでの Microsoft Developer Network サブスクリプションの作成が防止されます。

**設計上の推奨事項:**

- ビジネス ニーズや優先度に合わせて民主化された管理のユニットとして、サブスクリプションを扱います。
- サブスクリプションの所有者に各自のロールと責任を認識させます。
  - 1 年間に 4 回または 2 回、Azure AD Privileged Identity Management でアクセス レビューを実行し、ユーザーが顧客組織内を移動することで特権が急増しないことを確認します。
  - 予算の支出とリソースの使用を完全に所有します。
  - ポリシーのコンプライアンスを保証し、必要に応じて修復します。
- 新しいサブスクリプションの要件を特定するときは、次の原則を使用します。
  - **スケールの制限:** サブスクリプションは、コンポーネントのワークロードがプラットフォームのサブスクリプション制限内でスケーリングされるときのスケール ユニットとして機能します。 たとえば、ハイパフォーマンス コンピューティング、IoT、SAP などの大規模で特殊なワークロードはすべて、制限 (Azure Data Factory の統合に対する 50 個の制限など) を回避するために個別のサブスクリプションを使用するのに適しています。
  - **管理の境界:** サブスクリプションによって、ガバナンスと分離のための管理境界が提供されます。これにより、問題を明確に分離することができます。 たとえば、開発、テスト、運用などのさまざまな環境は、多くの場合、管理の観点から分離されます。
  - **ポリシーの境界:** サブスクリプションは、Azure ポリシーの割り当ての境界として機能します。 たとえば、PCI などのセキュリティ保護されたワークロードでは、通常、コンプライアンスを実現するために追加のポリシーが必要になります。 別個のサブスクリプションが使用されている場合、この追加のオーバーヘッドを全体的に考慮する必要はありません。 同様に、開発環境では、運用環境と比較して、追加のポリシーが必要になります。
  - **ターゲット ネットワーク トポロジ:** 仮想ネットワークは、サブスクリプション間で共有することはできませんが、仮想ネットワーク ピアリングや Azure ExpressRoute などのさまざまなテクノロジを使用して接続することができます。 新しいサブスクリプションが必要かどうかを判断するときには、相互通信が必要なワークロードを検討してください。
- 大規模な管理グループの構造およびポリシー要件に合わせて、管理グループにサブスクリプションをグループ化します。 グループ化により、ポリシーと Azure ロール割り当てのセットが同じであるサブスクリプションでは、確実に管理グループからそれらが継承されるようにして、重複する割り当てを回避できます。
- `Platform` 管理グループで専用の管理サブスクリプションを設定し、Azure Monitor Log Analytics ワークスペースや Azure Automation Runbook などのグローバル管理機能をサポートします。
- 必要に応じて、`Platform` 管理グループで専用の ID サブスクリプションを設定し、Windows Server Active Directory ドメイン コントローラーをホストします。
- `Platform` 管理グループで専用の接続サブスクリプションを設定し、Azure Virtual WAN ハブ、プライベート ドメイン ネーム システム (DNS)、ExpressRoute 回線、その他のネットワーク リソースをホストします。 専用のサブスクリプションによって、すべての基盤ネットワーク リソースが一緒に請求され、他のワークロードから分離されることが保証されます。
- 硬直したサブスクリプション モデルを避け、代わりに柔軟な条件を設定して、組織全体でサブスクリプションをグループ化します。 この柔軟性により、組織の構造とワークロードの構成が変化したときに、既存のサブスクリプションの固定したセットを使用するのではなく、新しいサブスクリプション グループを作成できることが保証されます。 1 つのサイズがサブスクリプションのすべてに適合するわけではありません。 ある部署で動作するものが、別の部署では機能しない場合があります。 アプリケーションによっては、同じランディング ゾーンのサブスクリプション内で共存する場合もあれば、独自のサブスクリプションを必要とする場合もあります。

## <a name="configure-subscription-quota-and-capacity"></a>サブスクリプションのクォータと容量を構成する

各 Azure リージョンに含めることができるリソースの数には制限があります。 大量のリソースを必要とするエンタープライズ規模で Azure の導入を検討するときは、十分な容量と SKU を使用できることと、取得された容量を認識および監視できることを確実にしてください。

**設計上の考慮事項:**

- ワークロードに必要な各サービスについて、Azure プラットフォームでの制限とクォータを考慮します。
- 選択した Azure リージョンで必要な SKU を利用できるかどうかを検討します。 たとえば、新しい機能は特定のリージョンでしか使用できない場合があります。 VM など、特定のリソースに対する特定の SKU の可用性は、リージョンによって異なる場合があります。
- サブスクリプションのクォータは容量の保証ではなく、リージョンごとに適用されることを考慮します。

**設計上の推奨事項:**

- サブスクリプションをスケール ユニットとして使用し、必要に応じてリソースとサブスクリプションをスケールアウトします。 これにより、必要なときにスケールアウトに必要なリソースをワークロードで使用できるようになり、Azure プラットフォームでのサブスクリプションの制限に達することがなくなります。
- 必要なリージョンで予約容量を優先するには、予約インスタンスを使用します。 これにより、特定のリージョンでそのリソースが大量に必要になったときでも、ご利用のワークロードに必要な容量が確保されます。
- カスタム ビューを使用してダッシュボードを設定し、使用されている容量レベルを監視します。 容量使用率が重大レベルに達した場合のアラートを設定します (たとえば、CPU 使用率 90%)。
- サブスクリプションのプロビジョニングの一環として、クォータ増量のサポート リクエストを送ります (たとえば、サブスクリプションで使用可能な合計 VM コア数)。 このアプローチによって、ワークロードで既定の制限を超える量が必要になる前に、クォータ制限が確実に設定されます。
- 必要なサービスと機能が、選択したデプロイ リージョンで利用可能であることを確認します。

## <a name="establish-cost-management"></a>コスト管理を確立する

技術資産のコストの透明性は、すべての大規模なエンタープライズ組織にとって重要な管理上の課題となります。 このセクションでは、大規模な Azure 環境でコストの透明性を実現する方法に関する主要な側面について説明します。

**設計上の考慮事項:**

- Azure App Service Environment や Azure Kubernetes Service など、高密度を実現するためには共有することが必要な場合がある、共有のサービスとしてのプラットフォーム (PaaS) リソースが関係する場合は、チャージバック モデルが必要になることがあります。
- コストを最適化するには、非運用ワークロードのシャットダウン スケジュールを使用します。
- Azure Advisor を使用して、コストの最適化に関する推奨事項を確認します。

**設計上の推奨事項:**

- コスト集計には、Azure Cost Management + Billing を使用します。 アプリケーション所有者が使用できるようにします。
- Azure リソース タグを使用して、コストの分類とリソースのグループ化を行います。 タグを使用すれば、サブスクリプションを共有するワークロード、または複数のサブスクリプションにまたがる特定のワークロードに対して、チャージバック メカニズムを使用できます。

## <a name="policy-driven-governance"></a>ポリシー主導のガバナンス

エンタープライズ規模の Azure ポリシーを使用して、次のガバナンス要件を適用できます。

- **パブリック IP ベースのサービスを禁止する**

    Azure PaaS (サービスとしてのプラットフォーム) サービスのほとんどは、それらに割り当てられたパブリック IP アドレスを使用して作成されます。 このオプションは、これらのサービスをすぐに開始したい開発者に適しています。 パブリック エンドポイントは学習曲線を加速させるものであり、パイロットと小規模な概念実証 (PoC) の実装を開発する場合に最適です。

    ただし、これらのパイロット/PoC が、運用環境に対応したエンタープライズ アプリケーションに切り替えられる際に、パブリック IP アドレスの使用が見落とされることがあります。

    適切なセキュリティ対策が適用されていないパブリック IP を使用した運用ワークロードでは、セキュリティ リスクが高まる可能性があります。 悪意のあるアクターが、パブリック IP をゲートウェイとして使用して、攻撃を仕掛ける可能性があります。 多くの企業コンプライアンス ポリシーでは、このようなセキュリティ リスクにさらされないようにするだけのために、パブリック IP の使用を許可していません。

    パブリック IP アドレスの作成を拒否するというカスタム ポリシーがあります。これにより、ポリシーの対象となるスコープでパブリック IP を作成できなくなります。 企業は、このポリシーを使用して、Virtual Machines (VM) がパブリック IP で作成されるのを簡単に防ぐことができます。

    同様に、カスタム ポリシー イニシアチブ/PolicySet もあります。これにより、企業は、Azure サービスが最初にパブリック IP アドレスで作成されるのを防ぐことができます。

- **監査とログ情報のコレクションを適用する**

    詳細なレベルでの監査と診断情報が不足していると、運用方法に影響を及ぼす可能性があります。 監査情報が不完全である場合、複数の Azure サービスのログを相互に関連付けて、一貫したデバッグ エクスペリエンスを作成することが困難になります。

    Azure サービスをプロビジョニングしたら、それらがやり取りする Azure プラットフォームに関する詳細情報を提供する必要があります。
    このような情報は、ログとメトリックに大きく分けることができます。 各 Azure サービスは、サブコンポーネントにさらに分類できます (例: Azure パブリック IP リソースには、サブコンポーネントとして `DDoSProtectionNotifications`、`DDoSMitigationReports`、および `DDoSMitigationFlowLogs` があります)。 これらのサブカテゴリで診断情報を収集すると、監査とデバッグのエクスペリエンスが大幅に向上します。

     より深いレベルでログとメトリックの収集を実施するカスタムのポリシー イニシアチブを利用できます。これにより、企業は Azure サービスごとにログとメトリックを収集できます。 このイニシアチブには、すべての Azure サービスのポリシーが含まれています。 各 Azure サービスの重要なログ カテゴリとすべてのメトリックは、これらのポリシーによって自動的に収集されます。

- **SQL データベースの包括的なセキュリティを提供する**

     SQL データベースは、ほとんどの Azure のデプロイに共通の Azure サービスです。 残念ながら、これらは企業内外の悪意のあるアクティビティの格好のターゲットでもあります。

    特に SQL データベース用のカスタム ポリシー イニシアチブは、次の主要なガバナンス プラクティスを実装するのに役立ちます。

  - **SQL の保存データを暗号化する**

    SQL データベースとそのバックアップでは、悪意のあるアクターの手に渡るリスクが生じやすくなります。 データベース ファイルまたはバックアップから SQL データベースを復元するのは簡単です。 適切な防御システムが導入されていない場合、悪意のあるアクターはすべてのデータにアクセスできるおそれがあります。

    SQL データベースを保存時に暗号化することは、SQL データベースの防御戦略を構築する際の最初の手順の 1 つです。 Azure SQL データベースの Transparent Data Encryption (TDE) では、アプリケーション コード レベルの変更を必要とせずに、データを保存時に暗号化することができます。

    TDE が有効になっている SQL データベースを使用することで、侵害された場合でも、悪意のあるアクターが、保持されているデータにアクセスすることは難しくなります。

    企業内での Azure SQL データベースのデプロイが増加するにつれて、TDE が有効になった状態でそれらを作成することが重要になります。

    Azure SQL データベースで TDE が有効になっていることを確認するためのカスタム ポリシーがあります。

  - **疑わしいアクティビティに対してアラートを適用する**

    悪意のあるアクターは、ビジネスに不可欠な Azure SQL データベースにアクセスして悪用しようと常に目を光らせています。 このような試行が見過ごされるリスクがある場合、それらを検出して対応する企業の能力が低下してしまう可能性があります。 最悪のシナリオは、企業が、自社の SQL データベースが侵害されたかどうかを把握できないということです。

    Azure SQL データベースには、SQL Server で疑わしいアクティビティを報告するセキュリティ アラートを設定する方法が備わっています。 このアラートにより、事前に構成されたメール アドレスにメールが送信され、必要に応じて Azure サブスクリプション管理者と所有者にメールが送信されます。

    Azure SQL データベースでセキュリティ アラートを有効にするためのカスタム ポリシーがあります。 企業は、これらのアラートを通じて、SQL インジェクション攻撃やブルート フォース攻撃などの悪意のあるアクティビティを特定することができます。 セキュリティ アラートは、すべてのインシデントに関する詳細情報を提供します。 この詳細情報は Azure portal に表示されます。また、メール メッセージがトリガーされます。

  - **操作の監査証跡を適用する**

    ビジネスに不可欠な Azure SQL データベースには、日常業務の一環として、大量のデータ操作言語 (DML)、データ制御言語 (DCL)、およびデータ定義言語 (DDL) コマンドが適用されることがあります。 これらの運用アクティビティを明確に制御したり、それに関する分析情報を得たりせずに、正当な操作と疑わしい操作を区別することは困難です。

    SQL 監査を有効にすると、すべてのデータベース アクティビティに関する重要な情報を収集するのに役立ちます。 また、多くの業界/地域の規制コンプライアンス要件にも必要です。 SQL 監査は、データベース イベントの監査証跡の生成とレポートに役立ちます。

    企業はカスタム ポリシーを使用して、Azure SQL Database 監査を実施できます。 このポリシーは、所有権の変更、成功/失敗したログイン、ロールのメンバーシップの変更、スキーマの変更などの主要なデータベース イベントを監査およびレポートします。企業はこのポリシーおよび生成された監査証跡を使用して、データベース操作に関する豊富な分析情報を得て、業界または地域の規制要件に準拠することができます。

- **実績のあるベスト プラクティスに対して評価を実施する**

    Azure SQL データベースでは、そのライフサイクル全体にわたって多数のスキーマ、アクセス許可、および構成の変更が行われています。 このような変更には常に、ベスト プラクティスから逸脱してしまうリスクがあります。 過剰なアクセス許可、孤立したロール、およびそのような多くの設定のずれは、悪意のあるアクターによって悪用される可能性があります。

    Azure SQL データベースには、脆弱性評価サービスが組み込まれています。  Microsoft の SQL データベースのベスト プラクティスのレンズを通して Azure SQL データベースの状態を評価するには、脆弱性評価を使用します。 脆弱性評価スキャンでは、データベースとサーバー レベルのセキュリティ リスクが識別されます。 脆弱性を修正するために、適用可能なシナリオで修復タスクが生成されることもあります。

    にデプロイされたカスタム ポリシーを使用すると、Azure SQL データベースが脆弱性評価で構成されるようになります。 評価スキャンは定期的に行われ、レポートは Azure ストレージ アカウントに格納されます。 事前定義されたメール アドレスは、レポートの目的で定期的なスキャン結果を共有するために使用されます。

- **意図的または意図しないシークレットの削除から保護する**

    Azure Key Vault は、キー、証明書、パスワードなどの機密情報を格納するためのサービスです。悪意のあるユーザーが、その中に格納されているシークレットを削除することによって、Azure Key Vault サービスを悪用する可能性があります。 また、ユーザーが Azure Key Vault に格納されている機密情報を誤って削除する可能性も非常に高いといえます。 適切なプロビジョニングが実施されていない場合、Azure Key Vault で悪意のある削除または偶発的な削除が行われると、ビジネス上の大きな問題が発生する可能性があります。

    Azure Key Vault は、論理的な削除機能を使用して、内部に格納されているコンテンツが意図的または偶発的に削除されることを防ぎます。 論理的な削除が有効になっている場合、削除されたキーは事前に構成された期間保持されます。 削除操作が意図されたものではなかった場合、削除されたキーは、事前に構成された時間枠内で復元できます。 削除操作が意図的に行われた場合は、別の "*消去*" 操作 (通常は、高い特権を持つユーザーによって行われる) が完了するまでキー コンテンツを削除することができます。

    既定では、Azure Key Vault で論理的な削除機能が有効になっていることを確認するためのカスタム ポリシーがあります。 企業は、意図しない操作による Azure Key Vault コンテンツの削除をより適切に制御できるようになります。 このポリシーでは、Azure Key Vault コンテンツの悪意のある削除に対する追加のセキュリティ レイヤーも提供されます。

- **Web アプリケーション ファイアウォール (WAF) を実施する**

    Azure で実行されている Web アプリケーションは、悪意のある攻撃の対象となる可能性があります。 [上位 10 の一般的な攻撃](https://owasp.org/www-project-top-ten/) (挿入、クロスサイト スクリプティングなど) は通常、Web アプリケーションに関連付けられている既知の脆弱性を悪用しようとします。 攻撃が成功した場合の代償は高く、ブランド価値に悪影響を及ぼす可能性があります。

    Azure Application Gateway の Web Application Firewall (WAF) により、Web アプリケーションが一般的な攻撃から保護されます。 これは、Open Web Application Security Project (OWASP) によって推奨されているコア ルール セット (CRS) 3.1、3.0、または 2.2.9 を実装します。 WAF ポリシーは、"*防止*" または "*検出*" モードで Azure Application Gateway に関連付けることができます。

    Azure Application Gateway での潜在的な構成の誤りを防ぐのに役立つカスタム ポリシーがあります。 これにより、Web Application Firewall (WAF) を使用せずに Azure Application Gateway を作成することができなくなります。 Azure で実行され、Azure Application Gateway を使用する Web アプリケーションは、Azure Application Gateway の Web Application Firewall (WAF) によって保護されます。

- **VM での IP 転送を禁止する**

    IP 転送を使用すると、Azure VM は受信したトラフィックを他の宛先にルーティングできます。 明示的に要求されていない限り、このようなルーティングによって、パブリック IP アドレスを持つ VM がルーターとして公開される可能性があります。 IP 転送を使用して、VM が有効になっているルーター経由で、他の意図しないネットワークにアクセスされる可能性があります。

    Azure には、Virtual Machines (VM) で IP 転送を構成するオプションが用意されています。 このオプションを使用すると、ファイアウォールやロード バランサーなどの特別なソフトウェアを Azure Marketplace 経由でデプロイできます。 これらのサービスを使用する必要があるアプリケーションはすべて、Azure Marketplace トランザクションを介して使用できます。

    ただし、特定のニーズ以外では、VM での IP 転送がセキュリティ上の負担になる可能性があります。 VM が IP 転送ルーターとして機能しないようにするためのカスタム ポリシーがあります。 このポリシーは、ランディング ゾーンのスコープで明示的に適用されます。 ランディング ゾーン内の VM は、ユーザー要求の最終的な宛先である必要があります。 すべてのルーティングは、接続サブスクリプションに実装されている必要があります。

- **一元化された DNS レコード管理を適用する**

    Azure プライベート DNS ゾーンは、Azure リソースの DNS レコードを作成して管理するのに役立ちます。 Azure プライベート ゾーンが適切に管理されていないと、管理およびネットワーク接続のデバッグに問題が発生する可能性があります。 オンプレミス サイトから Azure リソースへの接続が必要なハイブリッド環境では、断片化された DNS ゾーンによって、DNS レコードと関連するメンテナンスの問題が重複する可能性があります。

    Azure プライベート DNS ゾーンは、DNS レコードの管理を容易にするために一元的にデプロイできます。 Azure プライベート ゾーンにリンクされている Azure Virtual Network は、ドメイン コントローラーを実行する可能性があります。これにより、オンプレミス サイトからの接続が合理化されます。 Private Link/エンドポイントをサポートする Azure サービスでは、一元的に管理された Azure プライベート ゾーンが使用されるため、アプリケーションのデプロイごとに作成する必要がありません。

    カスタム ポリシーをデプロイして、適用対象のスコープ内に Azure プライベート DNS ゾーンが作成されないようにすることができます。 企業は、ポリシーの適用が無効になっている場合でも、このポリシーに対するコンプライアンスの状態を表示できます。 このポリシーは、Private Link/エンドポイントを使用して、オンプレミス サイトからの接続を合理化し、Azure PaaS サービスにアクセスするのに役立ちます。

- **ネットワーク トラフィック制御を適用する**

    Azure Virtual Network (VNet) は、複数のサブネットにセグメント化できます。 既定では、これらのサブネット間にネットワーク アクセスの制御はありません。 ネットワーク アクセスの制御がないと、要請されていないネットワーク トラフィックがサブネット内に届く可能性があります。

    Azure ネットワーク セキュリティ グループ (NSG) は、サブネットとの間で送受信されるトラフィックをフィルター処理するのに役立ちます。 NSG では、ステートフル パケットの検査に基づいてネットワーク トラフィックを許可または拒否できます。 サブネット内のすべてのリソースは、許可された IP アドレス範囲からのトラフィックのみを受信できます。

    すべてのサブネットで NSG への関連付けを実施するカスタム ポリシーがあります。 サブネットと NSG を組み合わせることにより、既定の規則のセットがサブネットとの間のトラフィックを制御するようになります。 企業は、ニーズに基づいて、トラフィックをさらに制御する規則を追加または変更することができます。

- **Azure Security Center を使用してセキュリティの脅威を検出して保護する**

    Azure サブスクリプションは、VM、コンテナー イメージなどの複数の種類のリソースを保持できます。これらのリソースは、マルウェアや望ましくないソフトウェアのインストール、VM の管理ポートへの制御されていないアクセスなどのリスクにさらされます。セキュリティ攻撃がますます巧妙になり、経験豊富なセキュリティ専門家が限られているため、セキュリティの脆弱性を検出してワークロードを保護することは非常に困難です。

    Azure Security Center は、Azure のネイティブ セキュリティ管理システムであり、セキュリティのベスト プラクティスに照らして Azure リソースのセキュリティ対策を評価します。  Azure Security Center は、データとアプリケーション サービスに対する脅威を検出して防止するのに役立ちます。 複数の統合ポイントを使用すると、Azure Security Center を迅速にデプロイできます。

    カスタム ポリシーは、Azure サブスクリプションを Azure Security Center 標準モードで登録するのに役立ちます。これにより、Azure サブスクリプションでは、Azure Security Center によって提供されるセキュリティ脅威の検出と保護を開始できます。 このポリシーにより、VM、ストレージ アカウント、7 つの他のサービスなどの主要な Azure サービスが、Azure Security Center によって自動的にカバーされます。 企業は、セキュリティのベスト プラクティスから逸脱したとしても、継続的なセキュリティ評価と実用的なレコメンデーションによるベネフィットが得られます。

- **ランサムウェア攻撃や、その他のデータ損失に関連する問題から保護する**

    ランサムウェアや侵入による攻撃の頻度が高くなると、企業にとってさらに別の懸念事項が増えることになります。 ランサムウェア攻撃が成功すると、ビジネスに不可欠なプロセスやアプリケーションが中断される可能性があります。 攻撃者は、企業を人質にとって膨大な量の資金を要求することがわかっています。

    Azure Backup は、偶発的または意図的なデータの破棄から Azure VM を保護します。 Azure Backup では簡単に構成とスケーリングを実行できます。 データは、管理と保護を容易にするために、Azure Recovery Vault にバックアップされます。

    Azure Backup を構成して Azure VM を保護するカスタム ポリシーがあります。 このポリシーによって、Azure Recovery Services Vault が自動的にプロビジョニングされ、作成されるすべての Azure VM のバックアップ コンテナーが作成されます。

- **DDoS 攻撃から保護する**

    パブリックに到達可能な Azure リソースは、分散型サービス拒否 (DDoS) 攻撃の脅威にさらされています。 DDoS 攻撃が成功すると、対象ユーザーのアプリケーションの可用性に影響を与える可能性があります。 DDoS 攻撃が長時間になると、使用可能なすべてのリソースが枯渇し、ビジネスに不可欠なアプリケーションのダウンタイムが発生する可能性があります。

    Azure DDoS Protection サービスは、Azure リソースを DDoS 攻撃から保護します。 Azure DDoS Protection は、受信トラフィックを継続的にモニターして、DDoS 攻撃の可能性がある兆候を特定します。 企業は、攻撃を受けている最中に、Microsoft の DDoS Rapid Response (DRR) チームと協力することのベネフィットを得られます。

    すべての Azure サブスクリプションに対して Azure DDoS Standard プランをそのスコープ内に自動的にプロビジョニングするカスタム ポリシーがあります。 同じポリシーを使用して、企業は、割り当ての一部として対象となる Azure リージョンを選択することもできます。

- **プライベート DNS ゾーンで Private Link/エンドポイントを自動プロビジョニングする**

    Azure Private Link と Azure プライベート エンドポイントは、プライベート IP アドレスを使用して、Azure のサービスとしてのプラットフォーム (PaaS) サービスにアクセスできるようにします。 ただし、DNS レコードの解決には Azure プライベート DNS ゾーンが必要です。 Azure PaaS サービスにアクセスする必要があるすべてのアプリケーションに対して Azure プライベート ゾーンを作成することは、管理と保守の課題です。

    Azure プライベート DNS ゾーン グループは、サービスごとに Azure プライベート ゾーンを使用して、BLOB、キュー、テーブル、SQL などの Azure サービスによって Private Link 接続をグループ化するのに役立ちます。

    企業は、中央の Azure プライベート ゾーンを作成できます。カスタム ポリシーにより、Private Link/エンドポイントと Azure サービスのプライベート DNS ゾーンとの間の接続が自動的にプロビジョニングされます。

- **ファイアウォール規則を一元的に管理する**

    断片化されたファイアウォール規則では、制御されていない、あいまいなネットワーク トラフィック パスが発生する可能性があります。 ファイアウォールのすべてのインスタンスに対してファイアウォール規則を継続的に変更すると、ネットワークのセキュリティ体制を評価することが難しくなります。 複数の規則が存在すると、一元的に管理された基本的な規則セットとワークロード固有のネットワーク パス規則を区別できなくなります。

    Azure Firewall ポリシーは、企業全体に適用される基本的な最小セットの規則を定義するのに役立ちます。 アプリケーション固有のポリシーは、基本規則を継承して、企業およびアプリケーション固有のファイアウォール規則要件の両方を満たす階層的な規則を作成することができます。 規則がポリシーによって構成されている場合は、一元的に管理およびモニターできます。

    企業はカスタム ポリシーを使用して、Azure Firewall ポリシーを一元的に定義できます。 企業は、ネットワーク トラフィック ルーティングの要件を満たすために、規則と優先順位の定義を制御しています。 ファイアウォール ポリシーを一元的に定義すると、企業はニーズに応じて、Azure Virtual WAN または Azure ハブ アンド スポーク ネットワーク トポロジにそれらを適用できます。

- **ハブ アンド スポーク ネットワーク トポロジをプロビジョニングする**

    Azure にデプロイされるワークロードが増えるにつれて、ファイアウォールや VPN ゲートウェイなどの一般的なサービス セットの使用が開始されます。慎重に計画しないと、一般的なサービスのデプロイはアプリケーションのデプロイごとにレプリケートされ、結果として、不要なコストだけでなく、運用上のオーバーヘッドも発生してしまいます。 Azure からオンプレミスへの接続が必要なシナリオでは、アプリケーションのデプロイごとにこの接続が確立されるため、ネットワーク トポロジの保守が困難になります。

    Azure のハブ アンド スポーク ネットワーク トポロジによって、ネットワーク接続のニーズが合理化されます。 ハブの仮想ネットワーク (VNet) では、共有サービスをホストできるのに対し、スポークの VNet ではアプリケーション固有の Azure リソースをホストできます。 ハブ アンド スポークの VNet は、VNet ピアリング経由で相互に接続されます。 ハブ アンド スポークのネットワーク トポロジによって、クリーンなネットワーク設計が促進され、管理が容易になり、コストが最適化されます。

    Azure Firewall、VPN Gateway、および ExpressRoute (ER) ゲートウェイを使用してハブの VNet をプロビジョニングするカスタム ポリシーがあります。 企業では、ポリシー割り当ての一部として、ファイアウォール、VPN、および ER ゲートウェイのすべてのオプションを構成できます。 このポリシーにより、Azure ハブ アンド スポークのネットワーク トポロジをデプロイするプロセスが簡略化されます。

    別のカスタム ポリシーを使用すると、2 つの仮想ネットワーク (VNet) がハブの VNet 経由で相互に通信できるため、相互にピアリングされるのを防ぐことができます。 VNet がハブを介して相互に通信するように強制すると、ネットワーク接続を制御およびモニターできるようになります。 また、全体的なメンテナンスの観点からもネットワーク トポロジが簡略化されています。

- **Azure Monitor の既定の構成をプロビジョニングする**

    Azure プラットフォーム、Azure サービス、Azure アプリケーションの間の関係を特定して視覚化できないと、停止したり、パフォーマンスの低下を見過ごしたりする可能性があります。 運用チームやサポート チームは、特定の条件に対して是正措置を講じる機会を見逃してしまう可能性があります。 特定の Azure アプリケーションでは、需要の急増または落ち込みに対応するようにスケーリングできない場合があります。

    Azure Log Analytics ワークスペースと Azure Monitor ログを使用すると、企業はアラートを使用して重要な状況に対処することができます。 Azure Monitor ログと Log Analytics ワークスペースを一緒に使用することで、企業は、ダッシュボード、ブック、Power BI を通じて豊富なログ情報のセットを視覚化し、操作することができます。 企業は、Azure Monitor ログと Log Analytics ワークスペースを一緒に使用して、VM の自動スケールを構成し、余分なインスタンスを自動的に追加または削除することができます。

    カスタム ポリシーは、Azure Monitor で Log Analytics ワークスペースを構成するのに役立ちます。 このポリシーによって、Azure SQL Database や Azure Active Directory などの特定の Azure サービスの Azure Monitor ソリューションと呼ばれる、事前にパッケージ化されたダッシュボード レポートがデプロイされます。 また、Azure Monitor を使用して、Linux や Windows VM のパフォーマンス メトリックなどのデータ ソースが構成されます。

- **ログ ストレージとクエリを有効にする**

    慎重に計画しないと、複数のソースからのログ情報が Azure で簡単に扱いにくくなる可能性があります。 ログのキャプチャ、格納、および管理は、多くのリソース、時間、コストを消費する可能性があります。 長期間かつ大量のログにわたる傾向またはパターンを特定することは、困難になる可能性があります。

    Azure Log Analytics を使用すると、企業は複数のソースのログを効率的に保存して管理することができます。 Azure Log Analytics を使用すると、傾向またはパターンの分析のために Azure Log Analytics の格納データに対するクエリを簡単に実行できます。 アラートまたは対話型レポートは、Azure Log Analytics のクエリを使用して作成できます。

    ログ データを格納するためのリポジトリとして機能する Azure Log Analytics ワークスペースを作成するカスタム ポリシーがあります。 また、Azure Automation アカウントも作成され、タスクを自動化したり Azure Monitor ソリューションをデプロイしたりするための Log Analytics ワークスペースとリンクされています。これは、Log Analytics ワークスペースに依存している可能性があります。 また、ログの保持期間、Azure リージョンなどのプロパティの構成にも役立ちます。

- **Azure-Arc が有効になっているサーバーのログをプロビジョニングする**

    複数のクラウド、オンプレミス サイト、およびエッジの場所にまたがる IT 資産では、多くの企業が、複数の環境や地理的な場所に散在するサーバーの管理とガバナンスに苦労している可能性があります。 多数の製品を使用したサーバーのモニターは、煩雑な操作になる可能性があります。 1 つの統合アクセスと ID 管理ソリューションで、サーバーを複数の環境に配置すると、設定と管理が困難になることがあります。

    Azure Arc は、異種環境にまたがるサーバー、Kubernetes クラスター、データ サービスなどのリソースのガバナンスと管理を簡略化します。 Azure Arc はハイブリッド リソースをネイティブの Azure リソースとして射影して、ネイティブとハイブリッドのリソースを管理するための単一のウィンドウを提供します。 Azure Arc は、1 つの統合された RBAC ソリューションの下でネイティブとハイブリッドのリソースを提供します。

    1 組のカスタム ポリシーを使用することで、企業は Azure Arc 対応の Linux および Windows サーバーに Log Analytics エージェントを設定できます。 また、Log Analytics ワークスペースも、ログの格納と管理を行うように構成されています。 ポリシーは、正常に割り当てられると、Log Analytics エージェントで構成されているポリシーのスコープ内のサーバーの名前を返します。

- **ネットワーク トラフィック ログの収集を実施する**

    Azure Virtual Network (VNet) とサブネットは論理プライベート ネットワークの境界を提供しますが、Azure でのネットワーク トラフィックをモニターすることも重要です。 適切なネットワーク監視を行わないと、企業は、セキュリティ侵害された IP アドレスから Azure ネットワークに送信される望ましくない、または不明なトラフィックのリスクにさらされます。 現在のトラフィックを把握しないまま、ネットワーク トラフィックの増加に備えて追加の容量をプロビジョニングすることは困難になります。

    Azure Network Watcher には、Azure の IaaS サービスに関連するネットワークの問題を監視し、必要に応じて修復する方法が用意されています。 ネットワーク セキュリティ グループ (NSG) フロー ログは、NSG を通過するネットワーク トラフィックに関する情報を取得する方法を提供します。 企業は、トラフィック分析とパターンを活用して、将来の容量のニーズを予測し、企業のガバナンス ポリシーに準拠することができます。

    Azure Network Watcher NSG フロー ログの設定に役立つカスタム ポリシーがあります。 Azure Storage アカウントは、NSG フロー ログを格納するリポジトリとしてプロビジョニングされます。 このポリシーでは、NSG フロー ログを格納する保持期間を構成することもできます。  

- **大規模なネットワーク接続ソリューションをプロビジョニングする**

    企業のネットワーク接続の要件は複雑になる可能性があります。 拡大し続けるネットワークに新しいサイト、デバイス、およびユーザーを追加するという絶え間ない要求の中で、プロビジョニングと管理を行うのは非常に困難です。 企業内の複数のタッチポイントによるネットワーク帯域幅とスループットの要求は、非常に厳しい場合があります。

    Azure Virtual WAN (vWAN) は、Any-to-Any 接続の課題に対処することを目的とした企業レベルのネットワーク サービスです。 Azure vWAN では、ネットワーク接続を使用した高レベルのスループットが提供されます。 Azure のバックボーンに対する最適なルーティングと、Azure による統合された管理エクスペリエンスが提供されます。

    カスタム ポリシーを使用すると、Azure vWAN を設定できます。
    このポリシーは、vWAN 内で Azure vWAN ハブをプロビジョニングするのに役立ちます。 企業は、複数のソースと宛先からの接続の中心点として機能する仮想ハブをデプロイできます。 ExpressRoute、VPN ゲートウェイ、および Azure Firewall も、Any-to-Any のネットワーク接続要件に対応するためにプロビジョニングされます。  

- **Azure VM のバックアップをプロビジョニングする**

    クラウドの導入が増加するにつれて、企業は Azure で実行されているワークロードを確実にバックアップするという課題に直面しています。 アプリ開発と IT 運用が別々のチームによって管理される従来の IT サポート モデルでは、VM バックアップの所有権が不明確なままになることがあります。 ワークロードの復元に VM バックアップを必要とする意図的または偶発的なシナリオでは、バックアップ処理がないと、結果としてコストがかかる可能性があります。

    Azure Backup には、Azure またはオンプレミス サイトで実行されている VM をバックアップするためのシームレスで簡単で統合されたオプションが用意されています。 Azure Backup ではクラウド規模のストレージを使用するため、企業はバックアップに必要なストレージを常に調達して管理する必要がありません。 Azure Backup には、転送中および保存中のデータを安全に格納するリポジトリが用意されています。

    Windows および Linux VM の Azure バックアップ保護を自動的に構成するカスタム ポリシーがあります。 Recovery Service コンテナーは、バックアップを格納するように構成されています。これにより、データが安全に格納され、論理的な削除によるバックアップの悪意のある削除から保護されます。 既定のバックアップ ポリシーが作成され、バックアップ スケジュール、バックアップの保持期間などの事前構成された値で割り当てられます。

- **仮想ネットワーク (VNet) 間の接続をプロビジョニングする**

    ワークロードは、企業内の複数のサブスクリプションまたは仮想ネットワーク (VNet) に分散されているのが一般的です。 これらの間に専用のセキュリティで保護されたネットワーク接続がないと、重要なビジネス アプリケーションはデータ交換に苦労します。 インターネットベースのネットワーク接続では、ネットワーク帯域幅とパフォーマンスに整合性がなくなります。 ネットワーク待ち時間が長くなると、ユーザー エクスペリエンスが大幅に低下する可能性があります。

    Azure 仮想ネットワーク ピアリングは、Microsoft バックボーン ネットワーク経由で 2 つの仮想ネットワーク (VNet) 間のネットワーク接続を提供します。 Azure ピアリングにより、高帯域幅で低遅延のネットワーク接続が可能になります。 データは、個別の Azure サブスクリプション、テナント、または Azure リージョン間で安全に交換できます。

    カスタム ポリシーには、仮想ネットワーク ピアリングを設定するためのテンプレートが用意されています。 ARM テンプレート定義で表されるネットワーク レイアウトは、パラメーターとして渡すことができます。 このポリシーにより、仮想ネットワークがスピンアップし、NSG、UDR などの依存関係と共にその間の VNet ピアリングが構成されます。

- **AD ドメインに参加するように Windows VM を強制する**

    企業は、一貫した管理エクスペリエンスのためにドメインに参加している VM を使用しています。 企業パスワード ポリシー、集中認証などの操作がドメイン ポリシーの一部として作成された場合、ドメインに参加していない VM は、パスワードが脆弱であったり、企業のデバイスやアプリケーションに接続できないなどのリスクにさらされます。 NTLM、Kerberos などの認証プロトコルに依存するレガシ アプリケーションは、ドメインに参加していない VM にデプロイすると、認証の問題に直面する可能性があります。

    Azure には、ドメイン サービスを実装するためのマネージド ソリューションとアンマネージド ソリューションが用意されています。 Azure の自己管理型 Active Directory Domain Services (AD DS) を使用すると、企業は、オンプレミス環境と同じように、セットアップ、構成、および操作を完全に制御できます。 Azure Active Directory ドメイン サービス (AAD DS) は、企業の管理オーバーヘッドをすべて解消すると同時に、不可欠なドメイン サービスも提供します。

    新しく作成された Windows VM がドメインに自動的に参加するようにするカスタム ポリシー。 拡張機能 - *Jsonaddomainextension* - は、ユーザー名、ドメイン、OUPath などの他の構成設定を使用する VM 上にデプロイされ、VM が指定されたドメインに参加するようにします。 このポリシーでは、Azure KeyVault を使用して、ドメインのユーザー名やパスワードなどの機密情報を管理します。
